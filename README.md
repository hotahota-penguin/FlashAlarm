# FlashAlarm

フラッシュ暗算でアラームを止めるiOSアプリ

## 概要

FlashAlarmは、アラームを止めるためにフラッシュ暗算の問題を解く必要があるiOSアプリです。寝坊防止や脳のトレーニングに最適です。

## 主な機能

### 基本機能
- **アラーム管理**
  - 複数のアラームを作成・管理
  - アラームの有効/無効切り替え
  - スワイプで削除
  - アラームラベルのカスタマイズ

- **フラッシュ暗算**
  - 数字が順番に表示され、合計を計算
  - 桁数、数字の個数、表示速度をカスタマイズ可能
  - 正解するまでアラームが止まらない

### 高度な機能

#### アラーム設定
- **アラーム音選択**: 複数のシステムサウンドから選択可能
- **フラッシュ暗算カスタマイズ**
  - 桁数: 1〜5桁
  - 数字の個数: 3〜20個
  - 表示速度: 0.1〜3.0秒

#### 通知機能
- **スケジュール通知**: 指定時刻に自動的にアラームが鳴る
- **リピート通知**: 設定した間隔（1〜10分）で繰り返し通知
- **選択したアラーム音**: 通知でも設定したアラーム音が鳴る
- **フォアグラウンド対応**: アプリ起動中も自動的にフラッシュ暗算が開始
- **バックグラウンド対応**: 通知タップでアプリが起動し、フラッシュ暗算が開始
- **通知間起動対応**: 通知と通知の間にアプリを開いてもフラッシュ暗算が開始

#### セキュリティ機能
- **必須クリア**: 正解するまでアラームを止められない
- **試行回数制限**: 設定した回数（1〜10回）まで挑戦可能
- **最大試行回数超過時**: 強制的にアラームを止めることが可能

#### その他
- **アラーム永続化**: UserDefaultsでアラームを保存
- **自動無効化**: アラーム解除後、自動的にアラームがOFFになる
- **ユーザー設定**
  - 最大試行回数の設定
  - スヌーズ間隔の設定

## 技術仕様

- **プラットフォーム**: iOS
- **フレームワーク**: SwiftUI
- **通知**: UserNotifications Framework
- **音声**: AVFoundation, AudioToolbox
- **データ永続化**: UserDefaults
- **状態管理**: @Observable マクロ

## ファイル構成

```
FlashAlarm/
├── Models/
│   ├── Alarm.swift              # アラームデータモデル
│   ├── FlashAnzanSettings.swift # フラッシュ暗算設定
│   ├── AlarmSound.swift         # アラーム音定義
│   └── UserSettings.swift       # ユーザー設定
├── Services/
│   ├── AlarmStorage.swift       # アラーム永続化
│   ├── AlarmScheduler.swift     # 通知スケジューリング
│   └── AudioManager.swift       # 音声再生管理
└── Views/
    ├── AlarmListView.swift      # アラーム一覧画面
    ├── AlarmEditView.swift      # アラーム編集画面
    ├── FlashAnzanView.swift     # フラッシュ暗算画面
    └── SettingsView.swift       # 設定画面
```

## 使い方

1. **アラームを作成**
   - 「+」ボタンをタップ
   - 時刻、ラベル、フラッシュ暗算設定、アラーム音を設定
   - 「Save」をタップ

2. **アラームを有効化**
   - アラーム一覧でトグルをONにする

3. **アラームが鳴ったら**
   - 通知をタップしてアプリを開く
   - フラッシュ暗算の問題を解く
   - 正解するとアラームが止まる

4. **設定をカスタマイズ**
   - 歯車アイコンをタップ
   - 最大試行回数とスヌーズ間隔を設定

## 注意事項

- iOS通知の制限により、アプリあたり最大64個の通知をスケジュールできます
- 各アラームは10回のリピート通知を使用するため、約6個のアラームを同時に有効化できます
- バックグラウンドでの自動起動はiOSの制限により不可能です。通知をタップする必要があります

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。